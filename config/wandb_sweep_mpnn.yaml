program: run_sweep.py
method: bayes
metric:
  name: val_MeanAbsoluteError
  goal: minimize

early_terminate:
  type: hyperband
  min_iter: 50
  eta: 3
  s: 2

parameters:
  # Dataset config
  dataset.featurization:
    values: ["custom_molecular_graphs"]
  
  # General hyperparameters
  loss_type:
    values: ["mae", "mse"]
  
  mixture_model.dropout_rate:
    values: [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5]
  
  lr_mol_encoder:
    values: [8e-5, 5e-5, 1e-4, 5e-4, 8e-4, 1e-3, 5e-3, 1e-2]
  
  lr_other:
    values: [8e-5, 5e-5, 1e-4, 5e-4, 8e-4, 1e-3, 5e-3, 1e-2]
  
  # Molecular-level hyperparameters
  mixture_model.fraction_aggregation.type:
    values: ["concat", "multiply", "film"]
  
  mixture_model.fraction_aggregation.film.activation:
    values: ["sigmoid", "relu"]
  
  # Mixture-level hyperparameters
  mixture_model.mix_encoder.type:
    values: ["self_attn", "deepset"]
  
  mixture_model.mix_encoder.self_attn.add_mlp:
    values: [true, false]
  
  mixture_model.mix_encoder.embed_dim:
    values: [32, 64, 96, 128]
  
  mixture_model.mix_encoder.num_layers:
    values: [0, 1, 2, 3]
  
  mixture_model.mol_aggregation:
    values: ["mean", "max", "pna", "scaled_pna", "attention", "set2set"]
  
  mixture_model.attn_num_heads:
    values: [1, 4, 8, 16]
  
  mixture_model.mol_encoder.output_dim:
    values: [96, 128, 256]
  
  mixture_model.context_aggregation.type:
    values: ["concat", "film"]
  
  mixture_model.context_aggregation.film.activation:
    values: ["sigmoid", "relu"]
  
  # Predictive head hyperparameters
  mixture_model.regressor.hidden_dim:
    values: [64, 128, 192, 256, 320]
  
  mixture_model.regressor.num_layers:
    values: [1, 2, 3]
  
  # GNN-specific hyperparameters (only used when featurization is custom_molecular_graphs)
  mixture_model.mol_encoder.type:
    values: ["mpnn"]
  
  mixture_model.mol_encoder.mpnn.hidden_dim:
    values: [64, 128, 192, 256, 320]
  
  mixture_model.mol_encoder.mpnn.depth:
    values: [2, 3, 4]
  
  # Fixed parameters
  max_epochs:
    value: 500
  
  patience:
    value: 100
  
  seed:
    value: 42
  
  batch_size:
    value: 1024
  
  num_workers:
    value: 8
  
  device:
    value: "cuda"
  
  weight_decay:
    value: 0
  
  early_stopping:
    value: true
